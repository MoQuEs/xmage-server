version: '3.8'

services:
  xmage:
    build: .
    container_name: xmage
    ports:
      - "17171:17171"
      - "17179:17179"
    extra_hosts:
      - example.com:0.0.0.0
    environment:
      - Xms=256M
      - Xmx=512M
      - serverAddress=example.com
      - serverName=mage-server
      - port=17171
      - secondaryBindPort=17179
      - backlogSize=800
      - numAcceptThreads=6
      - maxPoolSize=1000
      - leasePeriod=12000
      - socketWriteTimeout=10000
      - maxGameThreads=40
      - maxSecondsIdle=600
      - minUserNameLength=1
      - maxUserNameLength=32
      - invalidUserNamePattern=[^a-zA-Z0-9_- $]
      - minPasswordLength=0
      - maxPasswordLength=100
      - maxAiOpponents=50
      - saveGameActivated=false
      - authenticationActivated=false
      - adminPassword=admin
    volumes:
      - xmage-db:/xmage/mage-server/db
      - xmage-saved:/xmage/mage-server/saved

volumes:
  xmage-db:
    driver: local
  xmage-saved:
    driver: local
